---
layout: default
title: 游戏登录数据分析
---

 {{ page.title }}
================
<p class="meta">10 May 2013 - GuangZhou</p>



假如有以下玩家登录退出日志：
  
uid, urs, t_when(时间戳), ip, grade(等级), 行为(登录或退出), 地图编号
  
1001, xiao@gmail.com, 2013-02-04 09:30:00, 120.85.244.231, 45, 1(登录), 1024
  
1002, dada@gmail.com, 2013-02-04 09:30:05, 112.94.150.203, 50, 2(退出), 1024
  
.....
  
我们可以做出哪些数据分析呢？初步看去，我们似乎只能做些简单的在线人数和流失人数的统计。但是结合游戏的实际业务，我们还可以做些深入的探索研究，例如工作室小号判断、玩家掉线行为等内容。


1、玩家在线人数  
-------------------  
可以分别计算每日在线人数、PCU、ACU，不同等级段的在线人数，如果结合ip的地址数据库，还可以判断每个地区的游戏玩家人数。   
  
     
2、玩家在线时间   
-------------------   
对玩家的登录退出日志按照uid、时间戳进行排序，然后迭代解析数据日志记录，就可以计算玩家的在线时长。  
  
  
3、玩家登录行为分析   
-------------------   
对玩家的登录时间段按照小时段、或者周切分，可以判断游戏的人数高峰点、是否存在明显的周末效应。结合玩家的每日在线时长，可以给策划设定玩法的开始时间、玩法所需时长，提供参考建议。
  
  
4、玩家流失行为分析
-------------------
根据玩家的最后一次退出时间判断玩家是否流失。结合玩家等级判断是低等级段玩家流失严重，还是高等级段玩家流失严重。结合玩家ip判断哪个地区玩家的流失率更高。结合玩家等级和地图编号，可以初步判断玩家在游戏中哪个步骤过程更容易流失。然后可以进行下一步减少流失率的工作，例如客服电话关怀、回流礼包奖励等活动。
  
  
5、工作室号判断
-------------------
假设：工作室通行证帐号、登录时间点、登录ip段有明显的集中特征。例如有一堆通行证的帐号都为shell_game1@163.com, shell_game2@163.com, shell_game3@163.com ... 这种形式，或者这堆帐号都近乎同一时间点内登录，登录ip段也很相近，那么我们就可以理论上认为这些是工作室小号。
  
步骤：
  
1）将登录退出帐号按照一定的匹配规则进行分类，找出名称相似的帐号群；
  
2）对登录退出日志按照时间戳进行排序，找出登录或者退出时间点相近的帐号群；
  
3）结合1）和2）的工作，对不同帐号群疑似工作室号程度进行打分，按照疑似度进行排序；
  
4）反馈给运维童鞋预防工作室号，或者以后的数据分析工作排除这些工作室号。
  
注意：单凭登录退出日志只是给了个初步判断，还可以结合这些帐号在游戏中的行为进行判别分析。
  
  
6、游戏掉线行为分析
-------------------
假设：根据经验，我们认为大部分玩家掉线后会在短时间内再次上线，我们设定掉线后到下次上线的时间间隔只要小于N秒，就计算为1次掉线行为。另外玩家掉线在玩家登录退出日志中的行为字段为2（即代表退出游戏）
  
步骤：
  
1）从1秒定时间间隔递增到Nmax秒（超过Nmax就经验上认为不是掉线后上线了，例如300秒），分别计算不同时间间隔对应的掉线人数，通过迭代掉线人数曲线，找出最优的时间间隔N。 
  
2）首先对数据日志按照uid、时间戳排序，然后迭代解析数据日志记录（以下代码仅给出逻辑结构）
  
`cat data.txt | sort -t, -nk1,1 -k3,3 > sort_data.txt`
  
`for row in sort_data.txt:`
  
`    uid, urs, t_when, ip, grade, action, space = row.split(',')`
  
`    if last_uid == uid and action == 2 and last_action == 1 and unix_timestamp(t_when) - unix_timestamp(last_t_when) <= N`      
  
`        diaoxian = diaoxian + 1`
  
`    last_uid = uid`
  
`    last_action = action`    
  
`    last_t_when = t_when`
  
3）更进一步细分不同时间段、不同地图的掉线人数，找出掉线人数最多的时间段和地图，然后结合游戏不同玩法发生的时间段和地图，判断哪个玩法或时间段造成游戏顿卡，玩家频繁掉线。从而让产品优化对应的玩法，给玩家良好的体验。
  
缺点：如果只有玩家的登录日志，只能计算掉线人数，却无法计算掉线比例。例如A地图掉线人数1000，B地图掉线人数为500；但A地图路过的人数1500，B地图路过的人数却是550。所以单凭掉线人数，无法百分百判断哪个地图掉线严重程度更高。



